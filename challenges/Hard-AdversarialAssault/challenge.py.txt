import os
import numpy as np
from tensorflow.keras.models import load_model
from PIL import Image

# Load the pretrained MNIST model
model = load_model('model.h5')

# Decide which file to use
img_path = 'perturbed.png' if os.path.exists('perturbed.png') else 'original.png'

# Preprocess image
img = Image.open(img_path).convert('L').resize((28, 28))
x = np.array(img).reshape(1, 28, 28, 1) / 255.0

# Predict
pred = model.predict(x).argmax()

# Check for target label (3)
if pred == 3:
    print("flag{ml_adv_conquered}")
else:
    print("Model sees:", pred)
